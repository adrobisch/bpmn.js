// Generated by uRequire v0.6.15 - template: 'combined' 
// Combined template optimized with RequireJS/r.js v2.1.13 & almond.
/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(e,t){var n=!("function"!=typeof define||!define.amd),r="object"==typeof exports,i=r?require:function(e){throw new Error("uRequire detected missing dependency: '"+e+"' - in a non-nodejs runtime. All it's binding variables were 'undefined'.")},o=function(e,n,o,a,s,u,c){var d,l,f;return function(e){function t(e,t){return k.call(e,t)}function n(e,t){var n,r,i,o,a,s,u,c,d,l,f,h=t&&t.split("/"),p=v.map,m=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(h=h.slice(0,h.length-1),e=e.split("/"),a=e.length-1,v.nodeIdCompat&&w.test(e[a])&&(e[a]=e[a].replace(w,"")),e=h.concat(e),d=0;d<e.length;d+=1)if(f=e[d],"."===f)e.splice(d,1),d-=1;else if(".."===f){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||m)&&p){for(n=e.split("/"),d=n.length;d>0;d-=1){if(r=n.slice(0,d).join("/"),h)for(l=h.length;l>0;l-=1)if(i=p[h.slice(0,l).join("/")],i&&(i=i[r])){o=i,s=d;break}if(o)break;!u&&m&&m[r]&&(u=m[r],c=d)}!o&&u&&(o=u,s=c),o&&(n.splice(0,s,o),e=n.join("/"))}return e}function r(t,n){return function(){return h.apply(e,x.call(arguments,0).concat([t,n]))}}function i(e){return function(t){return n(t,e)}}function o(e){return function(t){g[e]=t}}function a(n){if(t(b,n)){var r=b[n];delete b[n],y[n]=!0,c.apply(e,r)}if(!t(g,n)&&!t(y,n))throw new Error("No "+n);return g[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e){return function(){return v&&v.config&&v.config[e]||{}}}var c,h,p,m,g={},b={},v={},y={},k=Object.prototype.hasOwnProperty,x=[].slice,w=/\.js$/;p=function(e,t){var r,o=s(e),u=o[0];return e=o[1],u&&(u=n(u,t),r=a(u)),u?e=r&&r.normalize?r.normalize(e,i(t)):n(e,t):(e=n(e,t),o=s(e),u=o[0],e=o[1],u&&(r=a(u))),{f:u?u+"!"+e:e,n:e,pr:u,p:r}},m={require:function(e){return r(e)},exports:function(e){var t=g[e];return"undefined"!=typeof t?t:g[e]={}},module:function(e){return{id:e,uri:"",exports:g[e],config:u(e)}}},c=function(n,i,s,u){var c,d,l,f,h,v,k=[],x=typeof s;if(u=u||n,"undefined"===x||"function"===x){for(i=!i.length&&s.length?["require","exports","module"]:i,h=0;h<i.length;h+=1)if(f=p(i[h],u),d=f.f,"require"===d)k[h]=m.require(n);else if("exports"===d)k[h]=m.exports(n),v=!0;else if("module"===d)c=k[h]=m.module(n);else if(t(g,d)||t(b,d)||t(y,d))k[h]=a(d);else{if(!f.p)throw new Error(n+" missing "+d);f.p.load(f.n,r(u,!0),o(d),{}),k[h]=g[d]}l=s?s.apply(g[n],k):void 0,n&&(c&&c.exports!==e&&c.exports!==g[n]?g[n]=c.exports:l===e&&v||(g[n]=l))}else n&&(g[n]=s)},d=l=h=function(t,n,r,i,o){if("string"==typeof t)return m[t]?m[t](n):a(p(t,n).f);if(!t.splice){if(v=t,v.deps&&h(v.deps,v.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=i,i=o),i?c(e,t,n,r):setTimeout(function(){c(e,t,n,r)},4),h},h.config=function(e){return h(e)},d._defined=g,f=function(e,n,r){n.splice||(r=n,n=[]),t(g,e)||t(b,e)||(b[e]=[e,n,r])},f.amd={jQuery:!0}}(),f("almond",function(){}),f("dojo/_base/declare",[],function(){return r?i("dojo/_base/declare"):"undefined"!=typeof o?o:i("dojo/_base/declare")}),f("dojo/_base/lang",[],function(){return r?i("dojo/_base/lang"):"undefined"!=typeof a?a:i("dojo/_base/lang")}),f("bpmn/Clazz",["require","exports","module","dojo/_base/declare","dojo/_base/lang"],function(e,t,n,r,i){var o={constructor:function(e){this.text=null,this.reference={},this.attribute={},e&&i.mixin(this,e)},addReference:function(e){this.reference[e.name]=e;var t=this.__internalFieldName(e.name);this[t]=e.containment===!0?[]:null,this[e.name]=function(t){return this.accessor(e.name,t)}},addAttribute:function(e){this.attribute[e.name]=e,this[e.name]=function(t){return this.accessor(e.name,t)}},accessor:function(e,t){var n=this.__internalFieldName(e);return null!=t&&void 0!=t&&(this[n]=t),this[n]},__internalFieldName:function(e){return"_"+e},init:function(){},setText:function(e){this.text=e}};return r("bpmn.Clazz",null,o)}),f("bpmn/util/Index",["require","exports","module","dojo/_base/declare"],function(e,t,n,r){var i={constructor:function(){this._={}},add:function(e,t){this._[e]=t},addArray:function(e,t){this._[e]||(this._[e]=[]),this._[e].push(t)},addMap:function(e,t,n){this._[e]||(this._[e]={}),this._[e][t]=n},item:function(e){return this._[e]}};return r("bpmn.util.Index",null,i)}),f("bpmn/BaseElement",["require","exports","module","dojo/_base/declare","./Clazz","./util/Index"],function(e,t,n,r,i){var o={constructor:function(){this.addReference({name:"documentation",type:function(){}}),this.addAttribute({name:"id",type:String}),this.addAttribute({name:"name",type:String});var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)});this.id(e)},init:function(){this._definitions.index.add(this.id(),this),this._definitions.index.addMap(this.declaredClass,this.id(),this)}};return r("bpmn.BaseElement",i,o)}),f("bpmn/CallableElement",["require","exports","module","dojo/_base/declare","./BaseElement"],function(e,t,n,r,i){var o={constructor:function(){this.addAttribute({name:"name",type:String})}};return r("bpmn.CallableElement",i,o)}),f("bpmn/Package",["require","exports","module","dojo/_base/declare"],function(e,n,r,i){var o={tagMap:{},constructor:function(){},registerClass:function(e){var t=e.prototype.tag;return t&&(this.tagMap[t.toLowerCase()]=e),e}},a=i("bpmn.Package",null,o);return t.bpmnPackage=new a}),f("bpmn/FlowElement",["require","exports","module","dojo/_base/declare","./BaseElement","./Package"],function(e,t,n,r,i,o){var a={tag:"flowElement",constructor:function(){},getDiagramElement:function(){return this._definitions.index.item(this.id()+":di")},getBounds:function(){return this.getDiagramElement().bounds()},getWaypoints:function(){return this.getDiagramElement().waypoints()}};return o.registerClass(r("bpmn.FlowElement",i,a))}),f("bpmn/FlowElementsContainer",["require","exports","module","dojo/_base/declare","./BaseElement","./FlowElement"],function(e,t,n,r,i,o){var a={constructor:function(){this.addReference({name:"flowElements",containment:!0,type:o})}};return r("bpmn.FlowElementsContainer",i,a)}),f("bpmn/Process",["require","exports","module","dojo/_base/declare","./CallableElement","./FlowElementsContainer","./Package"],function(e,t,n,r,i,o,a){var s={tag:"process",constructor:function(){this.addAttribute({name:"isExecutable",containment:!0,type:"boolean"})}};return a.registerClass(r("bpmn.Process",[o,i],s))}),f("bpmn/Collaboration",["require","exports","module","dojo/_base/declare","./Package"],function(e,t,n,r,i){var o={tag:"collaboration",constructor:function(){}};return i.registerClass(r("bpmn.Collaboration",null,o))}),f("bpmn/di/DiagramElement",["require","exports","module","dojo/_base/declare","../Clazz","../Package"],function(e,t,n,r,i,o){var a={tag:"diagramElement",constructor:function(){this.addAttribute({name:"id",type:String}),this.addAttribute({name:"bpmnElement",type:String})},init:function(){this._definitions.index.add(this.bpmnElement()+":di",this)}};return o.registerClass(r("bpmn.DiagramElement",i,a))}),f("bpmn/di/Bounds",["require","exports","module","dojo/_base/declare","../Clazz","../Package"],function(e,t,n,r,i,o){var a={tag:"Bounds",constructor:function(){this.addAttribute({name:"x",type:"float"}),this.addAttribute({name:"y",type:"float"}),this.addAttribute({name:"width",type:"float"}),this.addAttribute({name:"height",type:"float"})}};return o.registerClass(r("bpmn.Bounds",i,a))}),f("bpmn/di/BPMNShape",["require","exports","module","dojo/_base/declare","./DiagramElement","./Bounds","../Package"],function(e,t,n,r,i,o,a){var s={tag:"BPMNShape",constructor:function(){this.addReference({name:"bounds",type:o})}};return a.registerClass(r("bpmn.BPMNShape",i,s))}),f("bpmn/di/Waypoint",["require","exports","module","dojo/_base/declare","../Clazz","../Package"],function(e,t,n,r,i,o){var a={tag:"waypoint",constructor:function(){this.addAttribute({name:"x",type:"float"}),this.addAttribute({name:"y",type:"float"})},__internalFieldName:function(e){return e}};return o.registerClass(r("bpmn.Waypoint",i,a))}),f("bpmn/di/BPMNEdge",["require","exports","module","dojo/_base/declare","./DiagramElement","./Waypoint","../Package"],function(e,t,n,r,i,o,a){var s={tag:"BPMNEdge",constructor:function(){this.addReference({name:"waypoints",containment:!0,type:o})}};return a.registerClass(r("bpmn.BPMNEdge",i,s))}),f("bpmn/di/BPMNPlane",["require","exports","module","dojo/_base/declare","../Clazz","../Package","./BPMNShape","./BPMNEdge","./DiagramElement"],function(e,t,n,r,i,o,a,s,u){var c={tag:"BPMNPlane",constructor:function(){this.addReference({name:"diagramElements",containment:!0,type:u})}};return o.registerClass(r("bpmn.BPMNPlane",i,c))}),f("bpmn/di/BPMNDiagram",["require","exports","module","dojo/_base/declare","../Clazz","./BPMNPlane","../Package"],function(e,t,n,r,i,o,a){var s={tag:"BPMNDiagram",constructor:function(){this.addReference({name:"plane",type:o})}};return a.registerClass(r("bpmn.BPMNDiagram",i,s))}),f("bpmn/FlowNode",["require","exports","module","dojo/_base/declare","./FlowElement","./Package"],function(e,t,n,r,i,o){var a={tag:"flowNode",constructor:function(){},incoming:function(){var e=this._definitions.index.item("target:"+this.id());return e?e:[]},outgoing:function(){var e=this._definitions.index.item("source:"+this.id());return e?e:[]}};return o.registerClass(r("bpmn.FlowNode",i,a))}),f("bpmn/Event",["require","exports","module","dojo/_base/declare","./FlowNode","./Package"],function(e,t,n,r,i,o){var a={tag:"event",constructor:function(){}};return o.registerClass(r("bpmn.Event",i,a))}),f("bpmn/CatchEvent",["require","exports","module","dojo/_base/declare","./Event","./Package"],function(e,t,n,r,i,o){var a={tag:"catchEvent",constructor:function(){}};return o.registerClass(r("bpmn.CatchEvent",i,a))}),f("bpmn/StartEvent",["require","exports","module","dojo/_base/declare","./CatchEvent","./Package"],function(e,t,n,r,i,o){var a={tag:"startEvent",constructor:function(){}};return o.registerClass(r("bpmn.StartEvent",i,a))}),f("bpmn/ThrowEvent",["require","exports","module","dojo/_base/declare","./Event","./Package"],function(e,t,n,r,i,o){var a={tag:"throwEvent",constructor:function(){}};return o.registerClass(r("bpmn.ThrowEvent",i,a))}),f("bpmn/EndEvent",["require","exports","module","dojo/_base/declare","./ThrowEvent","./Package"],function(e,t,n,r,i,o){var a={tag:"endEvent",constructor:function(){}};return o.registerClass(r("bpmn.EndEvent",i,a))}),f("bpmn/BoundaryEvent",["require","exports","module","dojo/_base/declare","./CatchEvent","./Package"],function(e,t,n,r,i,o){var a={tag:"boundaryEvent",constructor:function(){}};return o.registerClass(r("bpmn.BoundaryEvent",i,a))}),f("bpmn/Activity",["require","exports","module","dojo/_base/declare","./FlowNode","./Package"],function(e,t,n,r,i,o){var a={tag:"activity",constructor:function(){}};return o.registerClass(r("bpmn.Activity",i,a))}),f("bpmn/Task",["require","exports","module","dojo/_base/declare","./Activity","./Package"],function(e,t,n,r,i,o){var a={tag:"task",constructor:function(){}};return o.registerClass(r("bpmn.Task",i,a))}),f("bpmn/UserTask",["require","exports","module","dojo/_base/declare","./Task","./Package"],function(e,t,n,r,i,o){var a={tag:"userTask",constructor:function(){}};return o.registerClass(r("bpmn.UserTask",i,a))}),f("bpmn/ServiceTask",["require","exports","module","dojo/_base/declare","./Task","./Package"],function(e,t,n,r,i,o){var a={tag:"serviceTask",constructor:function(){}};return o.registerClass(r("bpmn.ServiceTask",i,a))}),f("bpmn/BusinessRuleTask",["require","exports","module","dojo/_base/declare","./Task","./Package"],function(e,t,n,r,i,o){var a={tag:"businessRuleTask",constructor:function(){}};return o.registerClass(r("bpmn.BusinessRuleTask",i,a))}),f("bpmn/ReceiveTask",["require","exports","module","dojo/_base/declare","./Task","./Package"],function(e,t,n,r,i,o){var a={tag:"receiveTask",constructor:function(){}};return o.registerClass(r("bpmn.ReceiveTask",i,a))}),f("bpmn/SubProcess",["require","exports","module","dojo/_base/declare","./Activity","./FlowElementsContainer","./Package"],function(e,t,n,r,i,o,a){var s={tag:"subProcess",constructor:function(){}};return a.registerClass(r("bpmn.SubProcess",[i,o],s))}),f("bpmn/Gateway",["require","exports","module","dojo/_base/declare","./FlowNode","./Package"],function(e,t,n,r,i,o){var a={tag:"gateway",constructor:function(){}};return o.registerClass(r("bpmn.Gateway",i,a))}),f("bpmn/ExclusiveGateway",["require","exports","module","dojo/_base/declare","./Gateway","./Package"],function(e,t,n,r,i,o){var a={tag:"exclusiveGateway",constructor:function(){this.addAttribute({name:"default",type:String})},getDefault:function(){return this._definitions.index.item(this.default())}};return o.registerClass(r("bpmn.ExclusiveGateway",i,a))}),f("bpmn/ParallelGateway",["require","exports","module","dojo/_base/declare","./Gateway","./Package"],function(e,t,n,r,i,o){var a={tag:"parallelGateway",constructor:function(){}};return o.registerClass(r("bpmn.ParallelGateway",i,a))}),f("bpmn/ConditionExpression",["require","exports","module","dojo/_base/declare","./BaseElement","./Package"],function(e,t,n,r,i,o){var a={tag:"conditionExpression",constructor:function(){}};return o.registerClass(r("bpmn.ConditionExpression",i,a))}),f("bpmn/SequenceFlow",["require","exports","module","dojo/_base/declare","./FlowElement","./ConditionExpression","./Package"],function(e,t,n,r,i,o,a){var s={tag:"sequenceFlow",constructor:function(){this.addAttribute({name:"sourceRef",type:String}),this.addAttribute({name:"targetRef",type:String}),this.addReference({name:"conditionExpression",type:o})},getSourceRef:function(){return this._definitions.index.item(this._sourceRef)},getTargetRef:function(){return this._definitions.index.item(this._targetRef)},init:function(){this.inherited(arguments),this._definitions.index.addArray("target:"+this.targetRef(),this),this._definitions.index.addArray("source:"+this.sourceRef(),this)}};return a.registerClass(r("bpmn.SequenceFlow",i,s))}),f("bpmn/Definitions",["require","exports","module","dojo/_base/declare","./BaseElement","./Process","./Collaboration","./di/BPMNDiagram","./util/Index","./StartEvent","./EndEvent","./BoundaryEvent","./UserTask","./ServiceTask","./BusinessRuleTask","./ReceiveTask","./SubProcess","./ExclusiveGateway","./ParallelGateway","./SequenceFlow"],function(e,t,n,r,i,o,a,s,u){var c={tag:"definitions",constructor:function(){this.addReference({name:"collaboration",type:a}),this.addReference({name:"process",containment:!0,type:o}),this.addReference({name:"bpmnDiagram",type:s}),this.index=new u}};return r("bpmn.Defintions",i,c)}),f("bpmn/execution/TokenStore",["require","exports","module","dojo/_base/declare","dojo/_base/lang"],function(e,t,n,r){var i={constructor:function(e){this.tokenMap=e?e:{}},add:function(e,t){this.tokenMap[e]||(this.tokenMap[e]=[]),this.tokenMap[e].push(t)},drop:function(e,t){if(this.tokenMap[e])for(var n=0;t>n;n++)this.tokenMap[e].pop()},query:function(e){return this.tokenMap[e]?this.tokenMap[e]:[]},count:function(){var e=0;for(var t in this.tokenMap)e+=this.tokenMap[t].length;return e}};return r("bpmn.TokenStore",null,i)}),f("dojo/_base/array",[],function(){return r?i("dojo/_base/array"):"undefined"!=typeof s?s:i("dojo/_base/array")}),f("dojo/Deferred",[],function(){return r?i("dojo/Deferred"):"undefined"!=typeof u?u:i("dojo/Deferred")}),f("dojo/topic",[],function(){return r?i("dojo/topic"):"undefined"!=typeof c?c:i("dojo/topic")}),f("bpmn/execution/Instance",["require","exports","module","./TokenStore","dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Deferred","dojo/topic"],function(e,t,n,r,i,o,a,s,u){var c={constructor:function(e,t,n,i){this.definitions=e,this.configuration=t,this.tokenStore=new r(n),this.variables=i?i:{},this.behaviours["bpmn.StartEvent"]=this.behaviours.takeAll,this.behaviours["bpmn.EndEvent"]=this.behaviours.takeNone,this.behaviours["bpmn.UserTask"]=this.behaviours.takeNone,this.behaviours["bpmn.ServiceTask"]=this.behaviours.takeAll,this.behaviours["bpmn.ExclusiveGateway"]=this.behaviours.xor,this.behaviours["bpmn.ParallelGateway"]=this.behaviours.and},behaviours:{takeAll:function(e){return this.dropToken(e.id(),this.tokenStore),e.outgoing()},takeNone:function(){return[]},xor:function(e){if(this.dropToken(e.id(),this.tokenStore),1==e.outgoing().length)return e.outgoing();var t=null;if(o.map(e.outgoing(),function(e){var n=this.configuration[e.id()];!t&&n&&n(this)&&(t=e)},this),!t&&!e.getDefault())throw new Error("No transition evaluated to true and no default defined");return t},and:function(e){var t=!0,n=this.tokenStore.query(e.id()),r={};if(1==e.incoming().length)return a.hitch(this,this.behaviours.takeAll)(e);for(var i=0;i<n.length;i++){var s=n[i];r[s.from]=s}var u=[];return o.map(e.incoming(),function(e){r[e.id()]?u.push(e):t=!1},this),t?(o.map(u,function(e){a.hitch(this,this.dropToken)(e.sourceRef(),this.tokenStore)},this),a.hitch(this,this.behaviours.takeAll)(e)):[]}},dropToken:function(e,t,n){t.query(e).length>0&&t.drop(e,n?n:1)},copyVariables:function(e){if(e)for(var t in e)this.variables[t]=e[t]},start:function(e,t){return this.tokenStore.add(e,{from:null}),this.trigger(e,t)},trigger:function(e,t,n,r){console.log("trigger",e);var i=new s,r=r?r:new s;this.copyVariables(t);var o=this.definitions.index.item(e),c=n?this.behaviours[n]:this.behaviours[o.declaredClass],d=[].concat(a.hitch(this,c)(o,this.tokenStore));return console.log("next",d),d.length>0&&this.configuration.leave&&(this.configuration.leave(o),u.publish("flow:leave:"+o.id(),o)),0==d.length&&r.resolve(),d.map(function(e){this.tokenStore.add(e.targetRef(),{from:e.id()});var t="flow:enter:"+e.targetRef();u.publish(t,e.getTargetRef()),this.configuration.enter&&this.configuration.enter(e.getTargetRef());var n=this;i.then(function(){console.log("then for",e.id()),n.trigger(e.targetRef(),null,null,r)})},this),this.configuration[e]&&this.configuration[e]?this.configuration[e]({instance:this,promise:i}):(console.log("resolving",e,this.tokenStore.tokenMap),i.resolve()),r}};return i("bpmn.Instance",null,c)}),f("sax",[],function(){return r?i("sax"):"undefined"!=typeof e?e:i("sax")}),f("bpmn/util/Serializer",["require","exports","module","dojo/_base/declare","../Package","../Definitions","../BaseElement","sax"],function(t,n,r,i,o,a,s){var u={constructor:function(){},fromXML:function(t){if(t){var n=function(e,t,n,r){if(t.attributes[e]){var i=t.attributes[e].value;"float"==r&&(i=parseFloat(i)),"boolean"==r&&(i="true"==i.toLowerCase()),"integer"==r&&(i=parseInt(i)),n[e](i)}},r=e.parser(!0,{xmlns:!0,lowercase:!0,trim:!0});r.stack=[],Array.prototype.peek=function(){return 0==this.length?null:this[this.length-1]};var i={definitions:function(){r.definitions=new a,r.stack.push(r.definitions)},"default":function(e){var t=r.stack.peek(),i=e.local.toLowerCase(),a=o.tagMap[i]?o.tagMap[i]():new s;r.stack.push(a),a._definitions=r.definitions;for(var u in a.attribute)n(u,e,a,a.attribute[u].type);var c=null;for(var d in t.reference){var l=t.reference[d];if(a.isInstanceOf(l.type)){c=l;break}}a.init(),c&&c.containment===!0?t[c.name]().push(a):c&&t[c.name](a)}};return r.onerror=function(e){console.log("error",e)},r.onopentag=function(e){i[e.local]?i[e.local](e):i["default"](e)},r.onclosetag=function(){r.stack.pop()},r.ontext=function(e){r.stack.peek().setText(e)},r.onend=function(){},r.write(t).close(),r.definitions}}};return i("bpmn.util.Serializer",null,u)}),f("kinetic",[],function(){return r?i("kinetic"):"undefined"!=typeof n?n:i("kinetic")}),f("bpmn/util/diagram/Canvas",["require","exports","module","kinetic"],function(e,t,n,r){var i=function(e){this.scale=e.scale;var t=this.stage=new r.Stage({container:e.container,width:e.width?e.width:500,height:e.height?e.height:500});t.scale({x:this.scale,y:this.scale}),this.shapeLayer=new r.Layer,this.connectionsLayer=new r.Layer,this.labelLayer=new r.Layer,t.add(this.shapeLayer),t.add(this.connectionsLayer),t.add(this.labelLayer),this.createGroup=function(e){return new r.Group(e)},this.createRect=function(e){return new r.Rect(e)},this.createCircle=function(e){return new r.Circle(e)},this.createLine=function(e){return new r.Line(e)},this.createText=function(e){return new r.Text(e)},this.createPolygon=function(e){return e.closed=!0,new r.Line(e)},this.createPath=function(e){return new r.Path(e)},this.createArrowLine=function(e,t,n){var i=n?n:6,o=e[e.length-2],a=e[e.length-1],s=e[e.length-4],u=e[e.length-3],c=Math.atan2(a-u,o-s);t.points=e.concat([o-i*Math.cos(c-Math.PI/6),a-i*Math.sin(c-Math.PI/6),o,a,o-i*Math.cos(c+Math.PI/6),a-i*Math.sin(c+Math.PI/6)]);var d=new r.Line(t);return d},this.expandCanvasIfNeeded=function(e){var t=10,n=e.getX(),r=e.getY(),i=e.getWidth(),o=e.getHeight();(n+i)*this.scale>this.stage.getWidth()&&this.stage.setWidth((n+i+t)*this.scale),(r+o)*this.scale>this.stage.getHeight()&&this.stage.setHeight((r+o+t)*this.scale)}};return i}),f("bpmn/editor/ActivityRenderer",["require","exports","module"],function(){var e=function(e){this.markerPaths={"bpmn.ServiceTask":"m 22.701284,14.663851 c 0.432742,0 0.835353,-0.363368 0.894226,-0.807377 0,0 0.08274,-0.624013 0.08274,-1.366108 0,-0.742094 -0.08274,-1.366107 -0.08274,-1.366107 -0.05909,-0.444249 -0.461484,-0.807376 -0.894226,-0.807376 h -2.236261 c -0.432975,0 -0.882637,-0.285846 -0.998992,-0.6350536 -0.116355,-0.3492066 -0.276519,-1.4695496 0.02967,-1.7863558 L 21.076473,6.2586397 C 21.382428,5.9415935 21.40607,5.4006221 21.128856,5.0562152 L 19.269014,3.1299359 C 18.936402,2.8426498 18.414191,2.8671302 18.107771,3.1841824 L 16.526998,4.8210152 C 16.221042,5.1380613 15.710883,5.2657441 15.394032,5.1049407 15.076952,4.9441373 14.18852,4.2658838 14.18852,3.8175543 V 1.501988 c 0,-0.4483294 -0.350922,-0.86497745 -0.779725,-0.92617905 0,0 -0.60264,-0.085927 -1.319319,-0.085927 -0.716679,0 -1.319319,0.085927 -1.319319,0.085927 -0.429034,0.06096 -0.7799559,0.47784965 -0.7799559,0.92617905 v 2.3155663 c 0,0.4483295 -0.275824,0.9136994 -0.6133031,1.0344211 C 9.0394192,4.9724583 7.9576789,5.1383013 7.6514912,4.8212576 L 6.0707181,3.1844175 C 5.7645304,2.8673702 5.2420872,2.8428899 4.9097076,3.1299359 L 3.0496339,5.0559751 C 2.7721873,5.4003821 2.7958294,5.9413535 3.1020167,6.2583996 L 4.682558,7.8952336 C 4.9887458,8.2122798 5.1122872,8.7402903 4.9567595,9.0683769 4.8012323,9.3964637 4.14644,10.316643 3.7134658,10.316643 H 1.4774369 c -0.4329742,0 -0.83535274,0.363367 -0.89445788,0.807376 0,0 -0.082979,0.624013 -0.082979,1.366107 0,0.742335 0.082979,1.366108 0.082979,1.366108 0.0588733,0.444249 0.46148368,0.807376 0.89445788,0.807376 h 2.2362607 c 0.4329742,0 0.882405,0.285607 0.9987611,0.635054 0.116356,0.349206 0.2765193,1.46931 -0.029668,1.786356 l -1.5805412,1.636594 c -0.3061877,0.317046 -0.3298298,0.858017 -0.052384,1.202424 l 1.859842,1.926279 c 0.3326113,0.287047 0.8548228,0.262806 1.1610105,-0.05425 l 1.5807733,-1.636829 c 0.3061877,-0.316806 0.8161146,-0.444729 1.1331963,-0.283925 0.3170817,0.160802 1.2055136,0.839057 1.2055136,1.287386 v 2.315567 c 0,0.448089 0.3509218,0.864976 0.7799558,0.925938 0,0 0.602408,0.08568 1.319319,0.08568 0.71691,0 1.319319,-0.08568 1.319319,-0.08568 0.429035,-0.06119 0.779725,-0.477849 0.779725,-0.925938 v -2.315567 c 0,-0.448329 0.275825,-0.913939 0.613303,-1.034421 0.337479,-0.120482 1.419219,-0.286086 1.725407,0.03071 l 1.580541,1.636833 c 0.306188,0.316807 0.828631,0.341288 1.161243,0.05425 l 1.859842,-1.925559 c 0.277214,-0.344407 0.253804,-0.885138 -0.05262,-1.202424 l -1.58054,-1.636586 c -0.306188,-0.317046 -0.42973,-0.845056 -0.274202,-1.173383 0.155296,-0.328327 0.81032,-1.248266 1.243294,-1.248266 h 2.236492 z m -10.612039,2.218844 c -2.342882,0 -4.2421275,-1.966359 -4.2421275,-4.392569 0,-2.425728 1.8992455,-4.3925682 4.2421275,-4.3925682 2.342882,0 4.242127,1.9666002 4.242127,4.3925682 0,2.42597 -1.899245,4.392569 -4.242127,4.392569 z","bpmn.UserTask":"M 12.253681,11.77491 C 11.634895,10.657313 10.877364,9.7523027 10.117807,9.1196049 9.2316574,9.7684998 8.152074,10.163303 6.9752673,10.163303 5.7964351,10.163303 4.715839,9.7674875 3.8307021,9.1196049 3.0711453,9.7523027 2.313614,10.657313 1.6928029,11.77491 c -1.44011956,2.594568 -1.59810737,5.255948 -0.3544598,5.946348 0.5570083,0.310781 1.1413607,0.07896 1.7449552,-0.502109 -0.106338,0.589168 -0.1681153,1.22794 -0.1681153,1.896068 0,2.968112 1.1535136,5.372364 2.5754039,5.372364 0.8567801,0 1.2811192,-0.875654 1.4846804,-2.215961 0.2035612,1.340307 0.6279003,2.215961 1.4816421,2.215961 1.4239158,0 2.5774296,-2.404252 2.5774296,-5.372364 0,-0.668128 -0.06178,-1.3069 -0.170141,-1.896068 0.60562,0.581069 1.18896,0.81289 1.746981,0.502109 1.243647,-0.6904 1.082621,-3.35178 -0.357498,-5.946348 z M 6.9742546,9.1509867 c 2.3920975,0 4.3325124,-1.9395984 4.3325124,-4.3317023 0,-2.3921039 -1.9404149,-4.33170228 -4.3325124,-4.33170228 -2.3931103,0 -4.3345375,1.93959838 -4.3345375,4.33170228 0,2.3921039 1.9414272,4.3317023 4.3345375,4.3317023 z","bpmn.BusinessRuleTask":"M 0.49999997,0.68485673 V 3.8369982 H 24.501049 V 0.68485673 H 0.49999997 z m 0,17.05141427 H 24.501049 V 14.58413 H 0.49999997 v 3.152141 z m 0,-6.949637 H 24.501049 V 7.6344932 H 0.49999997 v 3.1521408 z m 0,13.898223 H 24.501049 V 21.532715 H 0.49999997 v 3.152142 z","bpmn.ReceiveTask":"M 1.7164479,0.59270005 9.5482144,6.784475 17.408905,0.54332386 z M 0.70000001,1.254341 l 0,11.06027 17.69642899,0 0,-11.06027 -8.8482146,6.6361608 z"},this.createRectangle=function(t){var n=e.skin().activity_corner_radius,r=e.canvas.createRect({width:t.width(),height:t.height(),cornerRadius:n,stroke:e.skin().activity_stroke,fill:e.skin().activity_fill,strokeWidth:2});return r},this.getPathForActivityType=function(e){return this.markerPaths[e.declaredClass]},this.createMarker=function(t){var n=e.canvas.createPath({x:3,y:3,data:t,stroke:e.skin().activity_stroke,fill:e.skin().activity_fill,scale:.6});return n},this.render=function(e,t){var n=e.getBounds(),r=this.createRectangle(n),i=this.getPathForActivityType(e),o=this.createMarker(i);return t.add(r),t.add(o),t}};return e}),f("bpmn/editor/EventRenderer",["require","exports","module"],function(){var e=function(){this.render=function(e,t){var n=e.getBounds(),r=this.canvas.createCircle({width:n.width(),height:n.height(),stroke:this.skin().event_stroke,strokeWidth:2,draggable:!0});return t.add(r),t}};return e}),f("bpmn/editor/GatewayRenderer",["require","exports","module"],function(){var e=function(){this.render=function(e,t){var n=e.getBounds(),r=this.canvas.createPolygon({points:[0,n.height()/2,n.width()/2,0,n.width(),n.height()/2,n.width()/2,n.height()],stroke:"black",fill:"white",strokeWidth:2,draggable:!0});return t.add(r),t}};return e}),f("bpmn/editor/LabelRenderer",["require","exports","module"],function(){var e=function(e){this.renderCentered=function(e,t,n){var r=this.createLabelText(n);return r.setY(e.height()/2-r.getFontSize()),r.setWidth(e.width()),t.add(r),t},this.createLabelText=function(t){return e.canvas.createText({text:t,fontSize:e.skin().label_font_size,fontFamily:e.skin().label_font_family,fill:e.skin().label_fill,align:"center"})}};return e}),f("bpmn/editor/Renderer",["require","exports","module","dojo/_base/declare","dojo/_base/array","../Activity","../Gateway","../Event","../SequenceFlow","../util/diagram/Canvas","./ActivityRenderer","./EventRenderer","./GatewayRenderer","./LabelRenderer"],function(e,t,n,r,i,o,a,s,u,c,d,l,f,h){var p={skins:{"default":{event_stroke:"black",activity_stroke:"black",activity_fill:"white",activity_corner_radius:10,label_font_family:"Arial",label_font_size:12,label_fill:"black"}},constructor:function(e,t){this.definitions=e,this.skinName="default",this.bindDelegates(),this.evaluateOptionsAndDefaults(t),this.canvas=new c(this.options)},bindDelegates:function(){this.activity=new d(this),this.renderEvent=(new l).render,this.renderGateway=(new f).render,this.label=new h(this)},evaluateOptionsAndDefaults:function(e){this.options=e,this.skinName=e.skin?e.skin:"default",this.options.scale=e.scale?e.scale:1},render:function(){this.renderElements(),this.canvas.shapeLayer.draw(),this.canvas.connectionsLayer.draw(),this.canvas.labelLayer.draw()},renderElements:function(){if(this.definitions.process().length>1)throw new Error("Only single process models are supported");i.forEach(this.definitions.process(),function(e){i.forEach(e.flowElements(),function(e){this.renderElement(e)},this)},this)},renderElement:function(e){var t=this.canvas.createGroup({draggable:!0});e instanceof u?(this.renderConnection(e,t),this.canvas.connectionsLayer.add(t)):e instanceof o?(this.label.renderCentered(e.getBounds(),this.activity.render(e,t),e.name()),this.canvas.shapeLayer.add(t),this.setGroupBounds(t,e.getBounds())):e instanceof s?(this.renderEvent(e,t),this.canvas.shapeLayer.add(t),this.setGroupBounds(t,this.eventBounds(e))):e instanceof a?(this.renderGateway(e,t),this.canvas.shapeLayer.add(t),this.setGroupBounds(t,e.getBounds())):console.log("unable to render flowElement",e),this.canvas.expandCanvasIfNeeded(t)},eventBounds:function(e){var t=e.getBounds();return{x:function(){return t.x()+t.width()/2},y:function(){return t.y()+t.height()/2},width:function(){return t.width()},height:function(){return t.height()}}},setGroupBounds:function(e,t){e.setX(t.x()),e.setY(t.y()),e.setWidth(t.width()),e.setHeight(t.height())},renderConnection:function(e,t){var n=[];i.forEach(e.getWaypoints(),function(e){n.push(e.x),n.push(e.y)});var r=this.canvas.createArrowLine(n,{stroke:"black",strokeWidth:2,lineCap:"round",lineJoin:"round"});return t.add(r),t},skin:function(){return this.skins[this.skinName]}};return r("bpmn.Renderer",null,p)}),f("bpmn/Bpmn",["require","exports","module","dojo/_base/declare","./Definitions","./execution/Instance","./util/Serializer","./editor/Renderer"],function(e,t,n,r,i,o,a,s){var u={constructor:function(){this.renderer=s,this.serializer=new a}};return r("bpmn.Bpmn",null,u)}),l("bpmn/Bpmn")};return n?define(["sax","kinetic","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/Deferred","dojo/topic"],o):r?module.exports=o(require("sax"),require("kinetic"),require("dojo/_base/declare"),require("dojo/_base/lang"),require("dojo/_base/array"),require("dojo/Deferred"),require("dojo/topic")):o("undefined"!=typeof sax?sax:void 0,"undefined"!=typeof Kinetic?Kinetic:void 0,"undefined"!=typeof declare?declare:void 0,"undefined"!=typeof l?l:void 0,"undefined"!=typeof array?array:void 0,"undefined"!=typeof Deferred?Deferred:void 0,"undefined"!=typeof topic?topic:void 0)}).call(this,"object"==typeof exports?global:window,"object"==typeof exports?global:window);